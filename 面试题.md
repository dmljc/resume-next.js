# Resume-Next é¡¹ç›®é¢è¯•é¢˜ï¼ˆ30 é“ï¼‰

> åŸºäº Next.js 16 + React 19 + Tailwind CSS 4 é¡¹ç›®çš„é¢è¯•é¢˜é›†åˆ

---

## ä¸€ã€åŸºç¡€çŸ¥è¯†ç¯‡ï¼ˆ1-10 é¢˜ï¼‰

### 1. ä»€ä¹ˆæ˜¯ Next.jsï¼Ÿå®ƒç›¸æ¯”ä¼ ç»Ÿçš„ React åº”ç”¨æœ‰å“ªäº›ä¼˜åŠ¿ï¼Ÿ

**ç­”æ¡ˆï¼š**
Next.js æ˜¯ä¸€ä¸ªåŸºäº React çš„å…¨æ ˆæ¡†æ¶ï¼Œæä¾›ä»¥ä¸‹ä¼˜åŠ¿ï¼š
- **æœåŠ¡ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰**ï¼šæå‡é¦–å±åŠ è½½é€Ÿåº¦å’Œ SEO
- **é™æ€ç«™ç‚¹ç”Ÿæˆï¼ˆSSGï¼‰**ï¼šæ„å»ºæ—¶é¢„æ¸²æŸ“ï¼Œæ€§èƒ½æ›´å¥½
- **æ–‡ä»¶ç³»ç»Ÿè·¯ç”±**ï¼šè‡ªåŠ¨æ ¹æ®æ–‡ä»¶ç»“æ„ç”Ÿæˆè·¯ç”±
- **API Routes**ï¼šå†…ç½®åç«¯ API åŠŸèƒ½
- **ä»£ç åˆ†å‰²**ï¼šè‡ªåŠ¨æŒ‰è·¯ç”±åˆ†å‰²ä»£ç 
- **å›¾ç‰‡ä¼˜åŒ–**ï¼šå†…ç½® Image ç»„ä»¶ä¼˜åŒ–å›¾ç‰‡åŠ è½½
- **é›¶é…ç½®**ï¼šå¼€ç®±å³ç”¨

---

### 2. è§£é‡Š Next.js ä¸­ App Router å’Œ Pages Router çš„åŒºåˆ«ï¼Ÿ

**ç­”æ¡ˆï¼š**
- **Pages Routerï¼ˆæ—§ç‰ˆï¼‰**ï¼š
  - åŸºäº `pages` ç›®å½•
  - ä½¿ç”¨ `_app.js` å’Œ `_document.js`
  - è·¯ç”±æ–‡ä»¶ç›´æ¥å¯¼å‡º React ç»„ä»¶

- **App Routerï¼ˆæ–°ç‰ˆï¼Œæœ¬é¡¹ç›®ä½¿ç”¨ï¼‰**ï¼š
  - åŸºäº `app` ç›®å½•
  - ä½¿ç”¨ `layout.jsx` å’Œ `page.jsx`
  - æ”¯æŒ Server Components
  - æ”¯æŒæµå¼æ¸²æŸ“ï¼ˆStreamingï¼‰
  - æ›´å¥½çš„åµŒå¥—å¸ƒå±€æ”¯æŒ
  - å†…ç½® loadingã€error çŠ¶æ€å¤„ç†

---

### 3. ä»€ä¹ˆæ˜¯ React Server Componentsï¼Ÿå®ƒä¸ä¼ ç»Ÿçš„å®¢æˆ·ç«¯ç»„ä»¶æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

**ç­”æ¡ˆï¼š**
**React Server Componentsï¼ˆRSCï¼‰**ï¼š
- åœ¨æœåŠ¡å™¨ç«¯æ¸²æŸ“ï¼Œä¸ä¼šå‘é€åˆ°å®¢æˆ·ç«¯
- æ— æ³•ä½¿ç”¨ useStateã€useEffect ç­‰å®¢æˆ·ç«¯ hooks
- å¯ä»¥ç›´æ¥è®¿é—®æ•°æ®åº“ç­‰åç«¯èµ„æº
- å‡å°‘å®¢æˆ·ç«¯ JavaScript åŒ…å¤§å°

**Client Componentsï¼ˆéœ€è¦ 'use client' æŒ‡ä»¤ï¼‰**ï¼š
- å¯ä»¥ä½¿ç”¨æ‰€æœ‰ React hooks
- å¯ä»¥æ·»åŠ äº¤äº’æ€§å’Œäº‹ä»¶ç›‘å¬å™¨
- åœ¨æµè§ˆå™¨ä¸­è¿è¡Œ

```javascript
// Server Component (é»˜è®¤)
export default function Page() {
  return <div>æˆ‘åœ¨æœåŠ¡å™¨æ¸²æŸ“</div>
}

// Client Component
'use client'
export default function Counter() {
  const [count, setCount] = useState(0)
  return <button onClick={() => setCount(count + 1)}>{count}</button>
}
```

---

### 4. æœ¬é¡¹ç›®ä¸­çš„ metadata å¯¹è±¡æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿå¦‚ä½•ä¼˜åŒ– SEOï¼Ÿ

**ç­”æ¡ˆï¼š**
metadata å¯¹è±¡ç”¨äºå®šä¹‰é¡µé¢çš„å…ƒæ•°æ®ï¼Œåœ¨ `layout.jsx` ä¸­é…ç½®ï¼š

```javascript
export const metadata = {
  title: 'å¼ èŠ³æœ - å…¨æ ˆå¼€å‘å·¥ç¨‹å¸ˆ',
  description: 'ä¸“æ³¨ä¸‰ç»´å¯è§†åŒ–ã€æ€§èƒ½ä¼˜åŒ–...',
  openGraph: { /* OG æ ‡ç­¾ */ },
  twitter: { /* Twitter å¡ç‰‡ */ },
  robots: { index: true, follow: true },
  verification: { google: '...', baidu: '...' }
}
```

**SEO ä¼˜åŒ–è¦ç‚¹**ï¼š
1. title æ§åˆ¶åœ¨ 25-60 å­—ç¬¦
2. description æ§åˆ¶åœ¨ 80-160 å­—ç¬¦
3. æ·»åŠ  Open Graph å’Œ Twitter å¡ç‰‡
4. é…ç½® robots å’Œ canonical
5. æ·»åŠ  JSON-LD ç»“æ„åŒ–æ•°æ®
6. æœç´¢å¼•æ“éªŒè¯ï¼ˆGoogleã€ç™¾åº¦ï¼‰

---

### 5. ä»€ä¹ˆæ˜¯ Tailwind CSSï¼Ÿå®ƒçš„ä¼˜åŠ¿å’Œå·¥ä½œåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ

**ç­”æ¡ˆï¼š**
**Tailwind CSS** æ˜¯ä¸€ä¸ªå®ç”¨ä¼˜å…ˆï¼ˆUtility-Firstï¼‰çš„ CSS æ¡†æ¶ã€‚

**ä¼˜åŠ¿**ï¼š
- ä¸éœ€è¦å‘½å CSS ç±»
- å“åº”å¼è®¾è®¡ç®€å•ï¼ˆ`sm:`, `md:`, `lg:`ï¼‰
- å†…ç½®è®¾è®¡ç³»ç»Ÿï¼ˆé—´è·ã€é¢œè‰²ã€å­—ä½“ç­‰ï¼‰
- å¼€å‘æ•ˆç‡é«˜
- ç”Ÿäº§ç¯å¢ƒè‡ªåŠ¨æ¸…ç†æœªä½¿ç”¨çš„æ ·å¼
- æ˜“äºå®šåˆ¶å’Œæ‰©å±•

**å·¥ä½œåŸç†**ï¼š
```jsx
// ä¼ ç»Ÿ CSS
<div className="card">...</div>
// CSS: .card { padding: 1rem; border-radius: 0.5rem; ... }

// Tailwind
<div className="p-4 rounded-lg bg-white shadow-md">...</div>
```

é¡¹ç›®ä½¿ç”¨ Tailwind v4ï¼Œé…ç½®åœ¨ `tailwind.config.cjs` å’Œ PostCSS ä¸­ã€‚

---

### 6. è§£é‡Š clsx å’Œ tailwind-merge çš„ä½œç”¨ï¼Ÿ

**ç­”æ¡ˆï¼š**
æœ¬é¡¹ç›®ä½¿ç”¨äº†è¿™ä¸¤ä¸ªå·¥å…·åº“ï¼š

**clsx**ï¼šæ¡ä»¶ç»„åˆç±»å
```javascript
import clsx from 'clsx'

clsx('foo', true && 'bar', { baz: false }) // 'foo bar'
clsx(['foo', 'bar'], { active: true }) // 'foo bar active'
```

**tailwind-merge**ï¼šæ™ºèƒ½åˆå¹¶ Tailwind ç±»åï¼Œè§£å†³å†²çª
```javascript
import { twMerge } from 'tailwind-merge'

// æ²¡æœ‰ twMerge
clsx('px-2', 'px-4') // 'px-2 px-4' (ä¸¤ä¸ªéƒ½ä¼šåº”ç”¨ï¼Œäº§ç”Ÿå†²çª)

// ä½¿ç”¨ twMerge
twMerge('px-2', 'px-4') // 'px-4' (åè€…è¦†ç›–å‰è€…)
```

é€šå¸¸ç»„åˆä½¿ç”¨ï¼š
```javascript
import { clsx } from 'clsx'
import { twMerge } from 'tailwind-merge'

export function cn(...inputs) {
  return twMerge(clsx(inputs))
}
```

---

### 7. é¡¹ç›®ä¸­ä½¿ç”¨äº†å“ªäº›ä»£ç è§„èŒƒå·¥å…·ï¼Ÿå®ƒä»¬å„è‡ªçš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ

**ç­”æ¡ˆï¼š**
æœ¬é¡¹ç›®ä½¿ç”¨äº†å®Œæ•´çš„ä»£ç è§„èŒƒå·¥å…·é“¾ï¼š

1. **ESLint**ï¼šJavaScript/JSX ä»£ç æ£€æŸ¥
   - é…ç½®æ–‡ä»¶ï¼š`eslint.config.mjs`
   - è§„åˆ™ï¼šåŒ…å« Next.jsã€Reactã€Prettier è§„åˆ™

2. **Prettier**ï¼šä»£ç æ ¼å¼åŒ–
   - é…ç½®æ–‡ä»¶ï¼š`prettier.config.js`
   - ç»Ÿä¸€ä»£ç é£æ ¼ï¼ˆç¼©è¿›ã€å¼•å·ã€åˆ†å·ç­‰ï¼‰

3. **Stylelint**ï¼šCSS æ ·å¼æ£€æŸ¥
   - é…ç½®ï¼šæ£€æŸ¥ CSS æ–‡ä»¶çš„è§„èŒƒ
   - åŒ…å« Tailwind CSS è§„åˆ™

4. **Commitlint**ï¼šGit æäº¤ä¿¡æ¯è§„èŒƒ
   - é…ç½®æ–‡ä»¶ï¼š`commitlint.config.cjs`
   - éµå¾ª Conventional Commits è§„èŒƒ

5. **Husky**ï¼šGit hooks ç®¡ç†
   - åœ¨æäº¤å‰è‡ªåŠ¨è¿è¡Œæ£€æŸ¥

6. **Lint-staged**ï¼šåªæ£€æŸ¥æš‚å­˜çš„æ–‡ä»¶
   - é…ç½®æ–‡ä»¶ï¼š`lint-staged.config.js`
   - æé«˜æ£€æŸ¥æ•ˆç‡

---

### 8. ä»€ä¹ˆæ˜¯ 'use client' æŒ‡ä»¤ï¼Ÿä»€ä¹ˆæ—¶å€™éœ€è¦ä½¿ç”¨å®ƒï¼Ÿ

**ç­”æ¡ˆï¼š**
`'use client'` æ˜¯ Next.js App Router ä¸­çš„æŒ‡ä»¤ï¼Œç”¨äºæ ‡è®°å®¢æˆ·ç«¯ç»„ä»¶ã€‚

**éœ€è¦ä½¿ç”¨çš„åœºæ™¯**ï¼š
1. ä½¿ç”¨ React hooksï¼ˆuseStateã€useEffectã€useContext ç­‰ï¼‰
2. ä½¿ç”¨æµè§ˆå™¨ APIï¼ˆlocalStorageã€window ç­‰ï¼‰
3. æ·»åŠ äº‹ä»¶ç›‘å¬å™¨ï¼ˆonClickã€onChange ç­‰ï¼‰
4. ä½¿ç”¨å®¢æˆ·ç«¯çŠ¶æ€ç®¡ç†
5. ä½¿ç”¨ç¬¬ä¸‰æ–¹å®¢æˆ·ç«¯åº“

**ç¤ºä¾‹ï¼ˆæœ¬é¡¹ç›®çš„ i18n.jsxï¼‰**ï¼š
```javascript
'use client';

import * as React from 'react';

export function I18nProvider({ children }) {
  const [lang, setLang] = React.useState('zh');
  
  React.useEffect(() => {
    // ä½¿ç”¨ localStorage
    const saved = localStorage.getItem('lang');
    if (saved) setLang(saved);
  }, []);
  
  // ...
}
```

---

### 9. è§£é‡Š React 19 çš„æ–°ç‰¹æ€§æœ‰å“ªäº›ï¼Ÿ

**ç­”æ¡ˆï¼š**
æœ¬é¡¹ç›®ä½¿ç”¨ React 19ï¼Œä¸»è¦æ–°ç‰¹æ€§åŒ…æ‹¬ï¼š

1. **Actions**ï¼šå¼‚æ­¥æ“ä½œçš„æ–°æ–¹å¼
   ```javascript
   <form action={async (formData) => {
     'use server'
     await saveData(formData)
   }}>
   ```

2. **useActionState**ï¼šè¡¨å•çŠ¶æ€ hook
3. **useFormStatus**ï¼šè¡¨å•çŠ¶æ€ç®¡ç†
4. **useOptimistic**ï¼šä¹è§‚æ›´æ–° UI
5. **use()** hookï¼šè¯»å– Promise å’Œ Context
6. **æ”¹è¿›çš„ ref å¤„ç†**ï¼šä¸å†éœ€è¦ forwardRef
7. **Document Metadata**ï¼šç›´æ¥åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ `<title>` ç­‰æ ‡ç­¾
8. **èµ„æºé¢„åŠ è½½**ï¼šæ”¹è¿›çš„èµ„æºåŠ è½½ API

---

### 10. æœ¬é¡¹ç›®çš„è·¯ç”±ç»“æ„æ˜¯æ€æ ·çš„ï¼Ÿå¦‚ä½•ç†è§£ Next.js çš„æ–‡ä»¶ç³»ç»Ÿè·¯ç”±ï¼Ÿ

**ç­”æ¡ˆï¼š**
é¡¹ç›®è·¯ç”±ç»“æ„ï¼ˆåŸºäº `src/app` ç›®å½•ï¼‰ï¼š

```
app/
â”œâ”€â”€ layout.jsx          # æ ¹å¸ƒå±€
â”œâ”€â”€ page.jsx           # é¦–é¡µ (/)
â”œâ”€â”€ not-found.jsx      # 404 é¡µé¢
â”œâ”€â”€ about/
â”‚   â””â”€â”€ page.jsx       # å…³äºé¡µé¢ (/about)
â””â”€â”€ resume/
    â””â”€â”€ page.jsx       # ç®€å†é¡µé¢ (/resume)
```

**æ–‡ä»¶ç³»ç»Ÿè·¯ç”±è§„åˆ™**ï¼š
- `page.jsx`ï¼šå®šä¹‰è·¯ç”±é¡µé¢
- `layout.jsx`ï¼šå®šä¹‰å…±äº«å¸ƒå±€
- `loading.jsx`ï¼šåŠ è½½çŠ¶æ€
- `error.jsx`ï¼šé”™è¯¯å¤„ç†
- `not-found.jsx`ï¼š404 é¡µé¢
- `route.js`ï¼šAPI è·¯ç”±

**ç‰¹æ®Šæ–‡ä»¶**ï¼š
- æ–‡ä»¶å¤¹åå†³å®š URL è·¯å¾„
- æ‹¬å·æ–‡ä»¶å¤¹ `[id]` è¡¨ç¤ºåŠ¨æ€è·¯ç”±
- æ‹¬å·æ‹¬å·æ–‡ä»¶å¤¹ `(group)` ç”¨äºç»„ç»‡ï¼Œä¸å½±å“ URL

---

## äºŒã€è¿›é˜¶åº”ç”¨ç¯‡ï¼ˆ11-20 é¢˜ï¼‰

### 11. æœ¬é¡¹ç›®å¦‚ä½•å®ç°å›½é™…åŒ–ï¼ˆi18nï¼‰ï¼Ÿè§£é‡Šå…¶å®ç°åŸç†ã€‚

**ç­”æ¡ˆï¼š**
é¡¹ç›®ä½¿ç”¨è‡ªå®šä¹‰çš„å›½é™…åŒ–æ–¹æ¡ˆï¼Œåˆ†ä¸ºä¸¤ä¸ªæ–‡ä»¶ï¼š

**1. i18n-core.js**ï¼šå®šä¹‰å­—å…¸å’Œ Context
```javascript
export const dict = {
  'key1': { zh: 'ä¸­æ–‡', en: 'English' }
}
export const I18nContext = React.createContext()
```

**2. i18n.jsx**ï¼šæä¾› Provider ç»„ä»¶
```javascript
'use client';

export function I18nProvider({ children }) {
  const [lang, setLang] = useState('zh');
  const [mounted, setMounted] = useState(false);
  
  // æŒ‚è½½åè¯»å– localStorage
  useEffect(() => {
    setMounted(true);
    const saved = localStorage.getItem('lang');
    if (saved) setLang(saved);
  }, []);
  
  // ä¿å­˜åˆ° localStorage
  useEffect(() => {
    if (mounted) {
      localStorage.setItem('lang', lang);
      document.documentElement.lang = lang === 'zh' ? 'zh-CN' : 'en';
    }
  }, [lang, mounted]);
  
  // ç¿»è¯‘å‡½æ•°
  const t = useCallback(key => {
    const entry = dict[key];
    return entry?.[lang] ?? entry?.zh ?? key;
  }, [lang]);
  
  // é˜²æ­¢æ°´åˆä¸åŒ¹é…
  if (!mounted) {
    return <div style={{ visibility: 'hidden' }}>{children}</div>
  }
  
  return <I18nContext.Provider value={{lang, setLang, toggleLang, t}}>
    {children}
  </I18nContext.Provider>
}
```

**å…³é”®ç‚¹**ï¼š
- ä½¿ç”¨ Context API ç®¡ç†è¯­è¨€çŠ¶æ€
- localStorage æŒä¹…åŒ–è¯­è¨€é€‰æ‹©
- ä½¿ç”¨ `mounted` çŠ¶æ€é˜²æ­¢ SSR æ°´åˆä¸åŒ¹é…
- åˆå§‹æ¸²æŸ“æ—¶éšè—å†…å®¹ï¼Œé¿å…é—ªçƒ

---

### 12. ä»€ä¹ˆæ˜¯ Hydration Mismatchï¼Ÿå¦‚ä½•é¿å…ï¼Ÿ

**ç­”æ¡ˆï¼š**
**Hydration Mismatch**ï¼šæœåŠ¡å™¨æ¸²æŸ“çš„ HTML ä¸å®¢æˆ·ç«¯æ¸²æŸ“çš„ç»“æœä¸ä¸€è‡´ã€‚

**å¸¸è§åŸå› **ï¼š
1. ä½¿ç”¨ `Date.now()` æˆ– `Math.random()`
2. ä½¿ç”¨ `localStorage` æˆ– `window` å¯¹è±¡
3. ç¬¬ä¸‰æ–¹åº“åœ¨æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯è¡Œä¸ºä¸åŒ
4. æ¡ä»¶æ¸²æŸ“ä¾èµ–å®¢æˆ·ç«¯çŠ¶æ€

**æœ¬é¡¹ç›®çš„è§£å†³æ–¹æ¡ˆï¼ˆi18n.jsxï¼‰**ï¼š
```javascript
const [mounted, setMounted] = useState(false);

useEffect(() => {
  setMounted(true);
  // è¯»å– localStorage
}, []);

if (!mounted) {
  // æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯åˆå§‹æ¸²æŸ“éƒ½è¿”å›åŒæ ·çš„å†…å®¹
  return <div style={{ visibility: 'hidden' }}>{children}</div>
}

// å®¢æˆ·ç«¯æŒ‚è½½åæ‰æ˜¾ç¤ºçœŸå®å†…å®¹
return <I18nContext.Provider ...>
```

**å…¶ä»–è§£å†³æ–¹æ¡ˆ**ï¼š
- ä½¿ç”¨ `useEffect` å»¶è¿Ÿå®¢æˆ·ç«¯ç‰¹å®šé€»è¾‘
- ä½¿ç”¨ `suppressHydrationWarning` å±æ€§ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰
- ç¡®ä¿æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯åˆå§‹çŠ¶æ€ä¸€è‡´

---

### 13. è§£é‡Šæœ¬é¡¹ç›®ä¸­çš„ JSON-LD ç»“æ„åŒ–æ•°æ®çš„ä½œç”¨ï¼Ÿ

**ç­”æ¡ˆï¼š**
JSON-LDï¼ˆJSON for Linking Dataï¼‰æ˜¯ä¸€ç§ç»“æ„åŒ–æ•°æ®æ ¼å¼ï¼Œå¸®åŠ©æœç´¢å¼•æ“ç†è§£é¡µé¢å†…å®¹ã€‚

**æœ¬é¡¹ç›®å®ç°ï¼ˆlayout.jsxï¼‰**ï¼š
```javascript
const jsonLd = {
  '@context': 'https://schema.org',
  '@type': 'Person',
  name: 'å¼ èŠ³æœ',
  jobTitle: 'å‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆ',
  url: 'https://zhangfc.cn',
  image: 'https://zhangfc.cn/resume.webp',
  sameAs: ['https://zhangfc.cn'],
  description: '9å¹´å‰ç«¯å¼€å‘ç»éªŒ...'
};

return (
  <html>
    <head>
      <script
        type="application/ld+json"
        dangerouslySetInnerHTML={{ __html: JSON.stringify(jsonLd) }}
      />
    </head>
  </html>
);
```

**ä½œç”¨**ï¼š
1. **æœç´¢å¼•æ“ä¼˜åŒ–**ï¼šå¸®åŠ© Google æ˜¾ç¤ºå¯Œåª’ä½“æœç´¢ç»“æœ
2. **çŸ¥è¯†å›¾è°±**ï¼šå¯èƒ½å‡ºç°åœ¨ Google çŸ¥è¯†é¢æ¿
3. **è¯­ä¹‰åŒ–**ï¼šæ˜ç¡®é¡µé¢å†…å®¹ç±»å‹
4. **SEO å¢å¼º**ï¼šæé«˜æœç´¢æ’å

**å¸¸è§ç±»å‹**ï¼š
- Personï¼šä¸ªäººä¿¡æ¯
- Organizationï¼šç»„ç»‡/å…¬å¸
- Articleï¼šæ–‡ç« 
- Productï¼šäº§å“
- Eventï¼šæ´»åŠ¨

---

### 14. é¡¹ç›®ä¸­çš„ ScrollTopButton å’Œ SectionNav ç»„ä»¶å¦‚ä½•å®ç°ï¼Ÿæ¶‰åŠå“ªäº›æŠ€æœ¯ç‚¹ï¼Ÿ

**ç­”æ¡ˆï¼š**
è¿™ä¸¤ä¸ªç»„ä»¶éœ€è¦ç›‘å¬æ»šåŠ¨ä½ç½®å’Œé”šç‚¹å¯¼èˆªï¼Œæ¶‰åŠä»¥ä¸‹æŠ€æœ¯ç‚¹ï¼š

**1. ScrollTopButtonï¼ˆå›åˆ°é¡¶éƒ¨æŒ‰é’®ï¼‰**ï¼š
```javascript
'use client';
import { useState, useEffect } from 'react';

export default function ScrollTopButton() {
  const [isVisible, setIsVisible] = useState(false);
  
  useEffect(() => {
    const toggleVisibility = () => {
      setIsVisible(window.scrollY > 300);
    };
    
    window.addEventListener('scroll', toggleVisibility);
    return () => window.removeEventListener('scroll', toggleVisibility);
  }, []);
  
  const scrollToTop = () => {
    window.scrollTo({ top: 0, behavior: 'smooth' });
  };
  
  return isVisible ? (
    <button onClick={scrollToTop}>Top</button>
  ) : null;
}
```

**2. SectionNavï¼ˆç« èŠ‚å¯¼èˆªï¼‰**ï¼š
```javascript
'use client';
import { useState, useEffect } from 'react';

export default function SectionNav() {
  const [activeSection, setActiveSection] = useState('home');
  
  useEffect(() => {
    const observer = new IntersectionObserver(
      (entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            setActiveSection(entry.target.id);
          }
        });
      },
      { threshold: 0.5 }
    );
    
    document.querySelectorAll('section[id]').forEach(section => {
      observer.observe(section);
    });
    
    return () => observer.disconnect();
  }, []);
  
  return (
    <nav>
      {sections.map(section => (
        <a
          href={`#${section.id}`}
          className={activeSection === section.id ? 'active' : ''}
        >
          {section.name}
        </a>
      ))}
    </nav>
  );
}
```

**æŠ€æœ¯ç‚¹**ï¼š
- `window.addEventListener('scroll')`ï¼šç›‘å¬æ»šåŠ¨
- `IntersectionObserver`ï¼šç›‘å¬å…ƒç´ å¯è§æ€§
- `window.scrollTo({ behavior: 'smooth' })`ï¼šå¹³æ»‘æ»šåŠ¨
- é”šç‚¹å¯¼èˆªï¼š`<a href="#section">`
- CSSï¼š`html { scroll-behavior: smooth }`

---

### 15. å¦‚ä½•åœ¨ Next.js ä¸­å¤„ç†å›¾ç‰‡ä¼˜åŒ–ï¼Ÿ

**ç­”æ¡ˆï¼š**
Next.js æä¾›äº† `next/image` ç»„ä»¶è¿›è¡Œå›¾ç‰‡ä¼˜åŒ–ï¼š

**åŸºç¡€ä½¿ç”¨**ï¼š
```javascript
import Image from 'next/image'

<Image
  src="/resume.webp"
  alt="ç®€å†ç…§ç‰‡"
  width={400}
  height={400}
  priority // ä¼˜å…ˆåŠ è½½
  quality={90} // å›¾ç‰‡è´¨é‡
  placeholder="blur" // æ¨¡ç³Šå ä½
  blurDataURL="..." // è‡ªå®šä¹‰å ä½å›¾
/>
```

**ä¼˜åŒ–ç‰¹æ€§**ï¼š
1. **è‡ªåŠ¨æ ¼å¼è½¬æ¢**ï¼šæ ¹æ®æµè§ˆå™¨æ”¯æŒè‡ªåŠ¨ä½¿ç”¨ WebP/AVIF
2. **æ‡’åŠ è½½**ï¼šé»˜è®¤æ‡’åŠ è½½ï¼Œå¯è®¾ç½® `priority`
3. **å“åº”å¼å›¾ç‰‡**ï¼šè‡ªåŠ¨ç”Ÿæˆå¤šå°ºå¯¸
4. **é˜²æ­¢å¸ƒå±€åç§»**ï¼šéœ€è¦æŒ‡å®šå®½é«˜
5. **CDN ä¼˜åŒ–**ï¼šè‡ªåŠ¨ä½¿ç”¨ CDN

**æœ¬é¡¹ç›®ä¸­çš„å›¾ç‰‡**ï¼š
```
public/
â”œâ”€â”€ resume.webp      # ç®€å†ç…§ç‰‡ï¼ˆå·²ä½¿ç”¨ WebP æ ¼å¼ï¼‰
â”œâ”€â”€ favicon.ico      # ç½‘ç«™å›¾æ ‡
â””â”€â”€ å¤‡æ¡ˆå›¾æ ‡.png
```

**æœ€ä½³å®è·µ**ï¼š
- ä½¿ç”¨ WebP/AVIF æ ¼å¼
- ä¸ºé‡è¦å›¾ç‰‡è®¾ç½® `priority`
- æŒ‡å®šå‡†ç¡®çš„å®½é«˜
- ä½¿ç”¨åˆé€‚çš„ qualityï¼ˆé»˜è®¤ 75ï¼‰

---

### 16. è§£é‡Š React.useCallback å’Œ React.useMemo çš„åŒºåˆ«å’Œä½¿ç”¨åœºæ™¯ï¼Ÿ

**ç­”æ¡ˆï¼š**
ä¸¤è€…éƒ½ç”¨äºæ€§èƒ½ä¼˜åŒ–ï¼Œä½†ç”¨é€”ä¸åŒï¼š

**useCallback**ï¼šç¼“å­˜å‡½æ•°å¼•ç”¨
```javascript
// æœ¬é¡¹ç›® i18n.jsx ä¸­çš„ä½¿ç”¨
const t = useCallback(
  key => {
    const entry = dict[key];
    return entry?.[lang] ?? entry?.zh;
  },
  [lang] // ä¾èµ–é¡¹
);

const toggleLang = useCallback(() => {
  setLang(lang === 'zh' ? 'en' : 'zh');
}, [lang]);
```

**useMemo**ï¼šç¼“å­˜è®¡ç®—ç»“æœ
```javascript
const expensiveValue = useMemo(() => {
  return computeExpensiveValue(a, b);
}, [a, b]);
```

**åŒºåˆ«å¯¹æ¯”**ï¼š
| ç‰¹æ€§ | useCallback | useMemo |
|------|------------|---------|
| è¿”å›å€¼ | ç¼“å­˜çš„å‡½æ•° | ç¼“å­˜çš„å€¼ |
| ç”¨é€” | é¿å…å­ç»„ä»¶ä¸å¿…è¦çš„é‡æ¸²æŸ“ | é¿å…é‡å¤çš„æ˜‚è´µè®¡ç®— |
| ç­‰ä»·å†™æ³• | `useCallback(fn, deps)` | `useMemo(() => fn, deps)` |

**ä½¿ç”¨åœºæ™¯**ï¼š
- **useCallback**ï¼š
  - ä¼ é€’ç»™å­ç»„ä»¶çš„å›è°ƒå‡½æ•°
  - useEffect çš„ä¾èµ–é¡¹
  - Context value ä¸­çš„å‡½æ•°
  
- **useMemo**ï¼š
  - å¤æ‚è®¡ç®—
  - å¤§æ•°æ®è¿‡æ»¤/æ’åº
  - ä¾èµ–é¡¹è®¡ç®—çš„å¯¹è±¡/æ•°ç»„

**æ³¨æ„**ï¼šä¸è¦è¿‡åº¦ä½¿ç”¨ï¼Œæœ‰æ—¶ç¼“å­˜çš„å¼€é”€æ¯”é‡æ–°è®¡ç®—æ›´å¤§ã€‚

---

### 17. æœ¬é¡¹ç›®å¦‚ä½•å¤„ç† 404 é¡µé¢ï¼ŸNext.js ä¸­è¿˜æœ‰å“ªäº›ç‰¹æ®Šè·¯ç”±æ–‡ä»¶ï¼Ÿ

**ç­”æ¡ˆï¼š**
**æœ¬é¡¹ç›®çš„ 404 é¡µé¢ï¼ˆnot-found.jsxï¼‰**ï¼š
```javascript
// app/not-found.jsx
export default function NotFound() {
  return (
    <div>
      <h2>é¡µé¢æœªæ‰¾åˆ°</h2>
      <p>æŠ±æ­‰ï¼Œæ‚¨è®¿é—®çš„é¡µé¢ä¸å­˜åœ¨ã€‚</p>
      <a href="/">è¿”å›é¦–é¡µ</a>
    </div>
  );
}
```

**Next.js ç‰¹æ®Šæ–‡ä»¶å®Œæ•´åˆ—è¡¨**ï¼š

| æ–‡ä»¶å | ç”¨é€” | ç¤ºä¾‹ |
|--------|------|------|
| `layout.jsx` | å…±äº«å¸ƒå±€ | é¡µå¤´ã€é¡µè„š |
| `page.jsx` | é¡µé¢å†…å®¹ | è·¯ç”±é¡µé¢ |
| `loading.jsx` | åŠ è½½çŠ¶æ€ | Suspense fallback |
| `error.jsx` | é”™è¯¯è¾¹ç•Œ | é”™è¯¯å¤„ç† |
| `not-found.jsx` | 404 é¡µé¢ | é¡µé¢ä¸å­˜åœ¨ |
| `template.jsx` | å¯é‡æ–°æŒ‚è½½çš„å¸ƒå±€ | æ¯æ¬¡å¯¼èˆªéƒ½é‡æ–°æŒ‚è½½ |
| `default.jsx` | å¹¶è¡Œè·¯ç”±å›é€€ | å¹¶è¡Œè·¯ç”± |
| `route.js` | API è·¯ç”± | GET/POST ç­‰ |
| `middleware.js` | ä¸­é—´ä»¶ | è¯·æ±‚æ‹¦æˆª |

**è§¦å‘ not-found**ï¼š
```javascript
import { notFound } from 'next/navigation'

export default async function Page({ params }) {
  const data = await fetchData(params.id);
  if (!data) notFound();
  return <div>{data.title}</div>
}
```

---

### 18. Tailwind CSS 4 ç›¸æ¯” v3 æœ‰å“ªäº›é‡å¤§å˜åŒ–ï¼Ÿ

**ç­”æ¡ˆï¼š**
æœ¬é¡¹ç›®ä½¿ç”¨ Tailwind CSS v4ï¼ˆä» package.json çœ‹åˆ° `^4.1.17`ï¼‰ï¼Œä¸»è¦å˜åŒ–ï¼š

**1. æ–°çš„å¼•æ“**ï¼š
- é‡å†™ä¸º Rust/TypeScript æ··åˆå¼•æ“
- æ„å»ºé€Ÿåº¦æå‡ 10 å€ä»¥ä¸Š
- æ›´å¥½çš„æ€§èƒ½

**2. é…ç½®æ–¹å¼æ”¹å˜**ï¼š
```css
/* v3: tailwind.config.js */

/* v4: ç›´æ¥åœ¨ CSS ä¸­é…ç½® */
@import "tailwindcss";

@theme {
  --color-primary: #3b82f6;
  --font-sans: 'Inter', sans-serif;
}
```

**3. PostCSS é…ç½®ç®€åŒ–**ï¼š
```javascript
// postcss.config.cjs
module.exports = {
  plugins: {
    '@tailwindcss/postcss': {} // æ–°æ’ä»¶
  }
}
```

**4. æ–°ç‰¹æ€§**ï¼š
- **å®¹å™¨æŸ¥è¯¢**ï¼š`@container` æ”¯æŒ
- **åŸç”Ÿçº§è”å±‚**ï¼šæ›´å¥½çš„ä¼˜å…ˆçº§æ§åˆ¶
- **æ”¹è¿›çš„å˜ä½“ç³»ç»Ÿ**
- **æ›´å¥½çš„ TypeScript æ”¯æŒ**

**5. å‘åå…¼å®¹**ï¼š
- å¤§éƒ¨åˆ† v3 è¯­æ³•ä»ç„¶æ”¯æŒ
- é…ç½®å¯ä»¥é€æ­¥è¿ç§»

---

### 19. å¦‚ä½•åœ¨ Next.js ä¸­å®ç°ä»£ç åˆ†å‰²å’Œæ‡’åŠ è½½ï¼Ÿ

**ç­”æ¡ˆï¼š**
Next.js æä¾›å¤šç§ä»£ç åˆ†å‰²æ–¹å¼ï¼š

**1. è‡ªåŠ¨è·¯ç”±åˆ†å‰²**ï¼š
```javascript
// æ¯ä¸ª page.jsx è‡ªåŠ¨åˆ†å‰²
app/
â”œâ”€â”€ page.jsx         // é¦–é¡µ bundle
â”œâ”€â”€ about/page.jsx   // about bundle
â””â”€â”€ resume/page.jsx  // resume bundle
```

**2. åŠ¨æ€å¯¼å…¥ï¼ˆDynamic Importï¼‰**ï¼š
```javascript
import dynamic from 'next/dynamic'

// å®¢æˆ·ç«¯ç»„ä»¶æ‡’åŠ è½½
const DynamicComponent = dynamic(() => import('./HeavyComponent'), {
  loading: () => <p>åŠ è½½ä¸­...</p>,
  ssr: false // ç¦ç”¨ SSR
})

export default function Page() {
  return <DynamicComponent />
}
```

**3. React.lazy + Suspense**ï¼š
```javascript
import { lazy, Suspense } from 'react'

const LazyComponent = lazy(() => import('./Component'))

export default function Page() {
  return (
    <Suspense fallback={<div>åŠ è½½ä¸­...</div>}>
      <LazyComponent />
    </Suspense>
  )
}
```

**4. æ¡ä»¶åŠ è½½**ï¼š
```javascript
function Page() {
  const [showModal, setShowModal] = useState(false)
  
  const Modal = dynamic(() => import('./Modal'))
  
  return (
    <>
      <button onClick={() => setShowModal(true)}>æ‰“å¼€å¼¹çª—</button>
      {showModal && <Modal />}
    </>
  )
}
```

**5. é¢„åŠ è½½**ï¼š
```javascript
import { prefetch } from 'next/link'

// é¼ æ ‡æ‚¬åœæ—¶é¢„åŠ è½½
<Link href="/about" onMouseEnter={() => prefetch('/about')}>
  å…³äºæˆ‘ä»¬
</Link>
```

**æœ€ä½³å®è·µ**ï¼š
- å¤§å‹ç»„ä»¶ä½¿ç”¨æ‡’åŠ è½½
- ç¬¬ä¸‰æ–¹åº“ï¼ˆå›¾è¡¨ã€ç¼–è¾‘å™¨ï¼‰å»¶è¿ŸåŠ è½½
- éé¦–å±å†…å®¹æ‡’åŠ è½½
- ä½¿ç”¨ Suspense æä¾›åŠ è½½çŠ¶æ€

---

### 20. é¡¹ç›®ä¸­å¦‚ä½•å®ç°æ·±è‰²æ¨¡å¼ï¼ˆDark Modeï¼‰ï¼Ÿ

**ç­”æ¡ˆï¼š**
è™½ç„¶å½“å‰é¡¹ç›®æœªå®ç°æ·±è‰²æ¨¡å¼ï¼Œä½†å¯ä»¥è¿™æ ·æ·»åŠ ï¼š

**æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨ Tailwind CSS**
```javascript
// 1. é…ç½® Tailwind
// tailwind.config.cjs
module.exports = {
  darkMode: 'class', // æˆ– 'media'
}

// 2. åˆ›å»º ThemeProvider
'use client';
import { createContext, useContext, useEffect, useState } from 'react';

const ThemeContext = createContext();

export function ThemeProvider({ children }) {
  const [theme, setTheme] = useState('light');
  
  useEffect(() => {
    const saved = localStorage.getItem('theme');
    if (saved) {
      setTheme(saved);
    } else {
      // æ£€æµ‹ç³»ç»Ÿåå¥½
      const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      setTheme(prefersDark ? 'dark' : 'light');
    }
  }, []);
  
  useEffect(() => {
    document.documentElement.classList.toggle('dark', theme === 'dark');
    localStorage.setItem('theme', theme);
  }, [theme]);
  
  const toggleTheme = () => {
    setTheme(prev => prev === 'dark' ? 'light' : 'dark');
  };
  
  return (
    <ThemeContext.Provider value={{ theme, toggleTheme }}>
      {children}
    </ThemeContext.Provider>
  );
}

// 3. ä½¿ç”¨æ·±è‰²æ ·å¼
<div className="bg-white dark:bg-gray-900 text-black dark:text-white">
  å†…å®¹
</div>

// 4. åˆ‡æ¢æŒ‰é’®
function ThemeToggle() {
  const { theme, toggleTheme } = useContext(ThemeContext);
  return (
    <button onClick={toggleTheme}>
      {theme === 'dark' ? 'ğŸŒ' : 'ğŸŒ™'}
    </button>
  );
}
```

**æ–¹æ¡ˆäºŒï¼šä½¿ç”¨ next-themes**
```bash
pnpm add next-themes
```

```javascript
// layout.jsx
import { ThemeProvider } from 'next-themes'

export default function RootLayout({ children }) {
  return (
    <html suppressHydrationWarning>
      <body>
        <ThemeProvider attribute="class" defaultTheme="system">
          {children}
        </ThemeProvider>
      </body>
    </html>
  )
}
```

**æŠ€æœ¯ç‚¹**ï¼š
- `prefers-color-scheme` åª’ä½“æŸ¥è¯¢
- localStorage æŒä¹…åŒ–
- `suppressHydrationWarning` é¿å…æ°´åˆè­¦å‘Š
- CSS å˜é‡æˆ– Tailwind dark: å‰ç¼€

---

## ä¸‰ã€é«˜çº§æ¶æ„ç¯‡ï¼ˆ21-30 é¢˜ï¼‰

### 21. è§£é‡Š Next.js çš„æ¸²æŸ“ç­–ç•¥ï¼šSSRã€SSGã€ISRã€CSR çš„åŒºåˆ«å’Œä½¿ç”¨åœºæ™¯ï¼Ÿ

**ç­”æ¡ˆï¼š**

**1. SSRï¼ˆServer-Side Renderingï¼ŒæœåŠ¡ç«¯æ¸²æŸ“ï¼‰**ï¼š
- æ¯æ¬¡è¯·æ±‚æ—¶åœ¨æœåŠ¡å™¨æ¸²æŸ“
- é€‚åˆåŠ¨æ€å†…å®¹ã€ä¸ªæ€§åŒ–é¡µé¢
- é¦–å±å¿«ï¼ŒSEO å¥½ï¼Œä½†æœåŠ¡å™¨å‹åŠ›å¤§

```javascript
// App Router ä¸­é»˜è®¤æ˜¯ SSRï¼ˆå¦‚æœæœ‰åŠ¨æ€æ•°æ®ï¼‰
export default async function Page() {
  const data = await fetch('https://api.example.com/data', {
    cache: 'no-store' // ä¸ç¼“å­˜
  });
  return <div>{data.title}</div>
}
```

**2. SSGï¼ˆStatic Site Generationï¼Œé™æ€ç«™ç‚¹ç”Ÿæˆï¼‰**ï¼š
- æ„å»ºæ—¶é¢„æ¸²æŸ“
- é€‚åˆå†…å®¹ä¸å¸¸å˜åŒ–çš„é¡µé¢ï¼ˆåšå®¢ã€æ–‡æ¡£ã€æœ¬é¡¹ç›®ï¼‰
- æ€§èƒ½æœ€å¥½ï¼ŒCDN å‹å¥½

```javascript
// App Router ä¸­é»˜è®¤æ˜¯ SSGï¼ˆå¦‚æœæ²¡æœ‰åŠ¨æ€æ•°æ®ï¼‰
export default function Page() {
  return <div>é™æ€å†…å®¹</div>
}

// æˆ–è€…æ˜ç¡®ç¼“å­˜
export default async function Page() {
  const data = await fetch('https://api.example.com/data', {
    cache: 'force-cache' // é»˜è®¤è¡Œä¸º
  });
  return <div>{data.title}</div>
}
```

**3. ISRï¼ˆIncremental Static Regenerationï¼Œå¢é‡é™æ€å†ç”Ÿï¼‰**ï¼š
- é™æ€ç”Ÿæˆ + å®šæœŸæ›´æ–°
- å…¼é¡¾æ€§èƒ½å’Œå†…å®¹æ–°é²œåº¦
- é€‚åˆå†…å®¹å®šæœŸæ›´æ–°çš„é¡µé¢

```javascript
export default async function Page() {
  const data = await fetch('https://api.example.com/data', {
    next: { revalidate: 3600 } // æ¯å°æ—¶é‡æ–°éªŒè¯
  });
  return <div>{data.title}</div>
}
```

**4. CSRï¼ˆClient-Side Renderingï¼Œå®¢æˆ·ç«¯æ¸²æŸ“ï¼‰**ï¼š
- åœ¨æµè§ˆå™¨æ¸²æŸ“
- é€‚åˆäº¤äº’å¯†é›†ã€éœ€è¦ç”¨æˆ·çŠ¶æ€çš„é¡µé¢
- SEO ä¸å‹å¥½

```javascript
'use client';
import { useState, useEffect } from 'react';

export default function Page() {
  const [data, setData] = useState(null);
  
  useEffect(() => {
    fetch('/api/data')
      .then(res => res.json())
      .then(setData);
  }, []);
  
  return <div>{data?.title}</div>
}
```

**æœ¬é¡¹ç›®ä½¿ç”¨ç­–ç•¥**ï¼š
- ä¸»é¡µã€å…³äºé¡µï¼šSSGï¼ˆé™æ€ç”Ÿæˆï¼‰
- ç®€å†é¡µï¼šSSGï¼ˆå†…å®¹ä¸å¸¸å˜ï¼‰
- äº¤äº’ç»„ä»¶ï¼ˆå¯¼èˆªã€å›½é™…åŒ–ï¼‰ï¼šCSR

---

### 22. å¦‚ä½•ä¼˜åŒ– Next.js åº”ç”¨çš„æ€§èƒ½ï¼Ÿåˆ—ä¸¾è‡³å°‘ 8 ç§æ–¹æ³•ã€‚

**ç­”æ¡ˆï¼š**

**1. å›¾ç‰‡ä¼˜åŒ–**ï¼š
```javascript
import Image from 'next/image'
<Image src="/pic.jpg" alt="" width={800} height={600} priority />
```

**2. å­—ä½“ä¼˜åŒ–**ï¼š
```javascript
// App Router
import { Inter } from 'next/font/google'

const inter = Inter({ subsets: ['latin'] })

export default function RootLayout({ children }) {
  return <html className={inter.className}>{children}</html>
}
```

**3. ä»£ç åˆ†å‰²**ï¼š
```javascript
const Heavy = dynamic(() => import('./Heavy'), { ssr: false })
```

**4. é¢„åŠ è½½å…³é”®èµ„æº**ï¼š
```javascript
// layout.jsx
export default function Layout() {
  return (
    <html>
      <head>
        <link rel="preload" href="/font.woff2" as="font" crossOrigin="" />
      </head>
    </html>
  )
}
```

**5. API è·¯ç”±ç¼“å­˜**ï¼š
```javascript
export async function GET() {
  const data = await fetchData();
  return Response.json(data, {
    headers: {
      'Cache-Control': 'public, s-maxage=3600, stale-while-revalidate=86400'
    }
  });
}
```

**6. ä½¿ç”¨ Suspense å’Œæµå¼æ¸²æŸ“**ï¼š
```javascript
import { Suspense } from 'react'

export default function Page() {
  return (
    <Suspense fallback={<Loading />}>
      <SlowComponent />
    </Suspense>
  )
}
```

**7. å‡å°‘ JavaScript åŒ…å¤§å°**ï¼š
```javascript
// ä½¿ç”¨ bundle analyzer
// package.json
{
  "scripts": {
    "analyze": "ANALYZE=true next build"
  }
}

// next.config.mjs
const withBundleAnalyzer = require('@next/bundle-analyzer')({
  enabled: process.env.ANALYZE === 'true',
})
module.exports = withBundleAnalyzer(nextConfig)
```

**8. ä¼˜åŒ–ç¬¬ä¸‰æ–¹è„šæœ¬**ï¼š
```javascript
import Script from 'next/script'

<Script
  src="https://analytics.example.com/script.js"
  strategy="lazyOnload" // æˆ– afterInteractive
/>
```

**9. ä½¿ç”¨ React Compilerï¼ˆReact 19ï¼‰**ï¼š
è‡ªåŠ¨ä¼˜åŒ–ç»„ä»¶ï¼Œå‡å°‘æ‰‹åŠ¨ memo å’Œ useCallback

**10. å¯ç”¨ Turbopack**ï¼ˆNext.js 14+ï¼‰ï¼š
```bash
next dev --turbo
```

**11. æ•°æ®è·å–ä¼˜åŒ–**ï¼š
```javascript
// å¹¶è¡Œè·å–
const [user, posts] = await Promise.all([
  fetchUser(),
  fetchPosts()
])

// é¢„å–æ•°æ®
<Link href="/blog" prefetch={true}>åšå®¢</Link>
```

**12. ä½¿ç”¨ CSS Modules æˆ– Tailwind**ï¼š
é¿å…è¿è¡Œæ—¶ CSS-in-JSï¼ˆstyled-componentsï¼‰

---

### 23. å¦‚ä½•åœ¨ Next.js ä¸­å®ç°ä¸­é—´ä»¶ï¼ˆMiddlewareï¼‰ï¼Ÿæœ‰å“ªäº›ä½¿ç”¨åœºæ™¯ï¼Ÿ

**ç­”æ¡ˆï¼š**
**ä¸­é—´ä»¶ï¼ˆMiddlewareï¼‰**ï¼šåœ¨è¯·æ±‚å®Œæˆå‰è¿è¡Œä»£ç ï¼Œå¯ä»¥ä¿®æ”¹å“åº”ã€‚

**åŸºç¡€å®ç°**ï¼š
```javascript
// middleware.js (é¡¹ç›®æ ¹ç›®å½•æˆ– src ç›®å½•)
import { NextResponse } from 'next/server'

export function middleware(request) {
  // è·å–è¯·æ±‚ä¿¡æ¯
  const { pathname } = request.nextUrl
  
  // é‡å®šå‘
  if (pathname === '/old-path') {
    return NextResponse.redirect(new URL('/new-path', request.url))
  }
  
  // é‡å†™
  if (pathname.startsWith('/blog')) {
    return NextResponse.rewrite(new URL('/news', request.url))
  }
  
  // è®¾ç½®å“åº”å¤´
  const response = NextResponse.next()
  response.headers.set('x-custom-header', 'value')
  
  return response
}

// é…ç½®åŒ¹é…è·¯å¾„
export const config = {
  matcher: [
    '/about/:path*',
    '/dashboard/:path*',
    '/((?!api|_next/static|_next/image|favicon.ico).*)',
  ]
}
```

**å¸¸è§ä½¿ç”¨åœºæ™¯**ï¼š

**1. èº«ä»½è®¤è¯**ï¼š
```javascript
export function middleware(request) {
  const token = request.cookies.get('token')
  
  if (!token && request.nextUrl.pathname.startsWith('/dashboard')) {
    return NextResponse.redirect(new URL('/login', request.url))
  }
  
  return NextResponse.next()
}
```

**2. å›½é™…åŒ–**ï¼š
```javascript
export function middleware(request) {
  const locale = request.cookies.get('locale') || 'zh'
  const { pathname } = request.nextUrl
  
  if (!pathname.startsWith(`/${locale}`)) {
    return NextResponse.redirect(
      new URL(`/${locale}${pathname}`, request.url)
    )
  }
}
```

**3. A/B æµ‹è¯•**ï¼š
```javascript
export function middleware(request) {
  const variant = Math.random() < 0.5 ? 'a' : 'b'
  const url = request.nextUrl.clone()
  url.pathname = `/experiments/${variant}${url.pathname}`
  
  const response = NextResponse.rewrite(url)
  response.cookies.set('variant', variant)
  
  return response
}
```

**4. é€Ÿç‡é™åˆ¶**ï¼š
```javascript
const rateLimitMap = new Map()

export function middleware(request) {
  const ip = request.ip ?? 'anonymous'
  const limit = rateLimitMap.get(ip) ?? 0
  
  if (limit > 10) {
    return new NextResponse('Too Many Requests', { status: 429 })
  }
  
  rateLimitMap.set(ip, limit + 1)
  
  return NextResponse.next()
}
```

**5. è¯·æ±‚æ—¥å¿—**ï¼š
```javascript
export function middleware(request) {
  console.log(`[${new Date().toISOString()}] ${request.method} ${request.url}`)
  return NextResponse.next()
}
```

**é™åˆ¶**ï¼š
- è¿è¡Œåœ¨ Edge Runtimeï¼ŒAPI æœ‰é™
- ä¸èƒ½ä½¿ç”¨ Node.js API
- åŒ…å¤§å°æœ‰é™åˆ¶ï¼ˆ1MBï¼‰

---

### 24. è§£é‡Š Git å·¥ä½œæµä¸­çš„ Husky + Lint-staged + Commitlint çš„é…åˆä½¿ç”¨ï¼Ÿ

**ç­”æ¡ˆï¼š**
è¿™æ˜¯æœ¬é¡¹ç›®ä½¿ç”¨çš„ä»£ç è´¨é‡ä¿éšœå·¥å…·é“¾ï¼Œç¡®ä¿ä»£ç æäº¤å‰çš„è´¨é‡ã€‚

**å®Œæ•´æµç¨‹**ï¼š

**1. Huskyï¼ˆGit Hooks ç®¡ç†ï¼‰**ï¼š
```bash
# å®‰è£…
pnpm add -D husky
pnpm exec husky init

# åˆ›å»º pre-commit hook
echo "npx lint-staged" > .husky/pre-commit

# åˆ›å»º commit-msg hook
echo "npx --no -- commitlint --edit $1" > .husky/commit-msg
```

**2. Lint-stagedï¼ˆåªæ£€æŸ¥æš‚å­˜æ–‡ä»¶ï¼‰**ï¼š
```javascript
// lint-staged.config.js
export default {
  '*.{js,jsx}': [
    'eslint --fix',
    'prettier --write'
  ],
  '*.css': [
    'stylelint --fix'
  ],
  '*.{json,md}': [
    'prettier --write'
  ]
}
```

**3. Commitlintï¼ˆæäº¤ä¿¡æ¯è§„èŒƒï¼‰**ï¼š
```javascript
// commitlint.config.cjs
module.exports = {
  extends: ['@commitlint/config-conventional'],
  rules: {
    'type-enum': [2, 'always', [
      'feat',     // æ–°åŠŸèƒ½
      'fix',      // ä¿®å¤ bug
      'docs',     // æ–‡æ¡£å˜æ›´
      'style',    // ä»£ç æ ¼å¼ï¼ˆä¸å½±å“ä»£ç è¿è¡Œï¼‰
      'refactor', // é‡æ„
      'perf',     // æ€§èƒ½ä¼˜åŒ–
      'test',     // æµ‹è¯•
      'chore',    // æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·å˜åŠ¨
      'revert'    // å›æ»š
    ]],
    'subject-case': [0]
  }
}
```

**4. Commitizenï¼ˆäº¤äº’å¼æäº¤ï¼‰**ï¼š
```javascript
// package.json
{
  "scripts": {
    "commit": "git-cz"
  },
  "config": {
    "commitizen": {
      "path": "node_modules/cz-git"
    }
  }
}
```

**å®Œæ•´å·¥ä½œæµ**ï¼š
```bash
# 1. ä¿®æ”¹ä»£ç 
vim src/app/page.jsx

# 2. æ·»åŠ åˆ°æš‚å­˜åŒº
git add .

# 3. æäº¤ï¼ˆè§¦å‘ hooksï¼‰
pnpm commit  # ä½¿ç”¨ commitizen
# æˆ–
git commit -m "feat: æ·»åŠ æ–°åŠŸèƒ½"

# æ‰§è¡Œé¡ºåºï¼š
# pre-commit hook â†’ lint-staged â†’ eslint/prettier
# commit-msg hook â†’ commitlint éªŒè¯æäº¤ä¿¡æ¯
```

**å¥½å¤„**ï¼š
- è‡ªåŠ¨æ ¼å¼åŒ–ä»£ç 
- é˜²æ­¢æäº¤æœ‰é—®é¢˜çš„ä»£ç 
- ç»Ÿä¸€æäº¤ä¿¡æ¯æ ¼å¼
- ä¾¿äºç”Ÿæˆ CHANGELOG
- æé«˜å›¢é˜Ÿåä½œæ•ˆç‡

---

### 25. å¦‚ä½•åœ¨ Next.js ä¸­å®ç° API è·¯ç”±ï¼Ÿæœ‰å“ªäº›æœ€ä½³å®è·µï¼Ÿ

**ç­”æ¡ˆï¼š**
è™½ç„¶æœ¬é¡¹ç›®æœªä½¿ç”¨ API è·¯ç”±ï¼Œä½†è¿™æ˜¯ Next.js çš„é‡è¦åŠŸèƒ½ã€‚

**åŸºç¡€å®ç°**ï¼š
```javascript
// app/api/users/route.js
import { NextResponse } from 'next/server'

// GET /api/users
export async function GET(request) {
  const { searchParams } = new URL(request.url)
  const page = searchParams.get('page') || '1'
  
  const users = await fetchUsers(page)
  
  return NextResponse.json(users, {
    status: 200,
    headers: {
      'Cache-Control': 'public, s-maxage=60'
    }
  })
}

// POST /api/users
export async function POST(request) {
  const body = await request.json()
  
  try {
    const user = await createUser(body)
    return NextResponse.json(user, { status: 201 })
  } catch (error) {
    return NextResponse.json(
      { error: error.message },
      { status: 400 }
    )
  }
}

// PUT, DELETE, PATCH ç±»ä¼¼
```

**åŠ¨æ€è·¯ç”±**ï¼š
```javascript
// app/api/users/[id]/route.js
export async function GET(request, { params }) {
  const { id } = params
  const user = await fetchUser(id)
  
  if (!user) {
    return NextResponse.json(
      { error: 'User not found' },
      { status: 404 }
    )
  }
  
  return NextResponse.json(user)
}
```

**æœ€ä½³å®è·µ**ï¼š

**1. é”™è¯¯å¤„ç†**ï¼š
```javascript
export async function GET(request) {
  try {
    const data = await fetchData()
    return NextResponse.json(data)
  } catch (error) {
    console.error('API Error:', error)
    return NextResponse.json(
      { error: 'Internal Server Error' },
      { status: 500 }
    )
  }
}
```

**2. å‚æ•°éªŒè¯**ï¼š
```javascript
import { z } from 'zod'

const userSchema = z.object({
  name: z.string().min(2),
  email: z.string().email()
})

export async function POST(request) {
  const body = await request.json()
  
  const result = userSchema.safeParse(body)
  if (!result.success) {
    return NextResponse.json(
      { errors: result.error.flatten() },
      { status: 400 }
    )
  }
  
  // ç»§ç»­å¤„ç†...
}
```

**3. è®¤è¯å’Œæˆæƒ**ï¼š
```javascript
import { auth } from '@/lib/auth'

export async function POST(request) {
  const session = await auth(request)
  
  if (!session) {
    return NextResponse.json(
      { error: 'Unauthorized' },
      { status: 401 }
    )
  }
  
  // ç»§ç»­å¤„ç†...
}
```

**4. CORS å¤„ç†**ï¼š
```javascript
export async function GET(request) {
  const response = NextResponse.json(data)
  
  response.headers.set('Access-Control-Allow-Origin', '*')
  response.headers.set('Access-Control-Allow-Methods', 'GET, POST, OPTIONS')
  
  return response
}

export async function OPTIONS() {
  return new NextResponse(null, {
    status: 200,
    headers: {
      'Access-Control-Allow-Origin': '*',
      'Access-Control-Allow-Methods': 'GET, POST, OPTIONS',
      'Access-Control-Allow-Headers': 'Content-Type'
    }
  })
}
```

**5. é€Ÿç‡é™åˆ¶**ï¼š
```javascript
import { ratelimit } from '@/lib/ratelimit'

export async function POST(request) {
  const ip = request.ip ?? 'anonymous'
  const { success } = await ratelimit.limit(ip)
  
  if (!success) {
    return NextResponse.json(
      { error: 'Too many requests' },
      { status: 429 }
    )
  }
  
  // ç»§ç»­å¤„ç†...
}
```

**6. ç¼“å­˜ç­–ç•¥**ï¼š
```javascript
export async function GET() {
  const data = await fetchData()
  
  return NextResponse.json(data, {
    headers: {
      // æµè§ˆå™¨ç¼“å­˜ 60 ç§’
      'Cache-Control': 'public, max-age=60',
      // CDN ç¼“å­˜ 1 å°æ—¶
      'CDN-Cache-Control': 'public, s-maxage=3600',
      // è¿‡æœŸåé‡æ–°éªŒè¯
      'Surrogate-Control': 'stale-while-revalidate=86400'
    }
  })
}
```

---

### 26. å¦‚ä½•è¿›è¡Œ Web æ€§èƒ½ç›‘æ§å’Œä¼˜åŒ–ï¼Ÿä»¥æœ¬é¡¹ç›®ä¸ºä¾‹è¯´æ˜ã€‚

**ç­”æ¡ˆï¼š**

**ä¸€ã€æ€§èƒ½æŒ‡æ ‡ï¼ˆCore Web Vitalsï¼‰**ï¼š

**1. LCPï¼ˆLargest Contentful Paintï¼‰**ï¼šæœ€å¤§å†…å®¹ç»˜åˆ¶
- ç›®æ ‡ï¼š< 2.5s
- ä¼˜åŒ–ï¼šå›¾ç‰‡ä¼˜åŒ–ã€æœåŠ¡ç«¯æ¸²æŸ“ã€é¢„åŠ è½½

**2. FIDï¼ˆFirst Input Delayï¼‰**ï¼šé¦–æ¬¡è¾“å…¥å»¶è¿Ÿ
- ç›®æ ‡ï¼š< 100ms
- ä¼˜åŒ–ï¼šå‡å°‘ JavaScriptã€ä»£ç åˆ†å‰²

**3. CLSï¼ˆCumulative Layout Shiftï¼‰**ï¼šç´¯ç§¯å¸ƒå±€åç§»
- ç›®æ ‡ï¼š< 0.1
- ä¼˜åŒ–ï¼šæŒ‡å®šå›¾ç‰‡å°ºå¯¸ã€é¿å…åŠ¨æ€æ’å…¥å†…å®¹

**äºŒã€æœ¬é¡¹ç›®æ€§èƒ½ä¼˜åŒ–å®è·µ**ï¼š

**1. Next.js æ€§èƒ½ç›‘æ§**ï¼š
```javascript
// app/layout.jsx
import { SpeedInsights } from '@vercel/speed-insights/next'
import { Analytics } from '@vercel/analytics/react'

export default function RootLayout({ children }) {
  return (
    <html>
      <body>
        {children}
        <SpeedInsights />
        <Analytics />
      </body>
    </html>
  )
}
```

**2. ä½¿ç”¨ Web Vitals API**ï¼š
```javascript
// lib/analytics.js
'use client';

export function reportWebVitals(metric) {
  console.log(metric)
  
  // å‘é€åˆ°åˆ†ææœåŠ¡
  if (metric.label === 'web-vital') {
    window.gtag?.('event', metric.name, {
      value: Math.round(metric.name === 'CLS' ? metric.value * 1000 : metric.value),
      event_label: metric.id,
      non_interaction: true
    })
  }
}

// app/layout.jsx
'use client';
import { useReportWebVitals } from 'next/web-vitals'

export function WebVitals() {
  useReportWebVitals(reportWebVitals)
  return null
}
```

**3. Lighthouse CI**ï¼š
```yaml
# .github/workflows/lighthouse.yml
name: Lighthouse CI
on: [push]
jobs:
  lighthouse:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
      - run: pnpm install
      - run: pnpm build
      - run: npx lighthouse-ci autorun
```

**4. Bundle åˆ†æ**ï¼š
```bash
# åˆ†ææ‰“åŒ…å¤§å°
pnpm add -D @next/bundle-analyzer

# next.config.mjs
import bundleAnalyzer from '@next/bundle-analyzer'

const withBundleAnalyzer = bundleAnalyzer({
  enabled: process.env.ANALYZE === 'true'
})

export default withBundleAnalyzer(nextConfig)

# è¿è¡Œåˆ†æ
ANALYZE=true pnpm build
```

**5. æ€§èƒ½é¢„ç®—**ï¼š
```javascript
// next.config.mjs
export default {
  experimental: {
    webpackBuildWorker: true,
  },
  // è®¾ç½®æ‰“åŒ…å¤§å°è­¦å‘Š
  onDemandEntries: {
    maxInactiveAge: 25 * 1000,
    pagesBufferLength: 2,
  }
}
```

**ä¸‰ã€ç›‘æ§å·¥å…·**ï¼š

1. **Google Analytics 4**ï¼šç”¨æˆ·è¡Œä¸ºåˆ†æ
2. **Google Search Console**ï¼šSEO ç›‘æ§
3. **Sentry**ï¼šé”™è¯¯ç›‘æ§
4. **Vercel Analytics**ï¼šæ€§èƒ½ç›‘æ§ï¼ˆå¦‚æœéƒ¨ç½²åœ¨ Vercelï¼‰
5. **è‡ªå®šä¹‰ç›‘æ§**ï¼š
```javascript
// ç›‘æ§ API å“åº”æ—¶é—´
export async function GET() {
  const start = Date.now()
  const data = await fetchData()
  const duration = Date.now() - start
  
  // è®°å½•æ€§èƒ½
  console.log(`API took ${duration}ms`)
  
  return NextResponse.json(data, {
    headers: {
      'Server-Timing': `db;dur=${duration}`
    }
  })
}
```

---

### 27. å¦‚ä½•å®ç° SSR åº”ç”¨çš„é˜²æ­¢æ°´åˆä¸åŒ¹é…ï¼ˆHydration Mismatchï¼‰çš„æœ€ä½³å®è·µï¼Ÿ

**ç­”æ¡ˆï¼š**
æ°´åˆä¸åŒ¹é…æ˜¯ SSR åº”ç”¨çš„å¸¸è§é—®é¢˜ï¼Œæœ¬é¡¹ç›®åœ¨å›½é™…åŒ–å®ç°ä¸­å·²ç»å¤„ç†äº†è¿™ä¸ªé—®é¢˜ã€‚

**å¸¸è§åŸå› å’Œè§£å†³æ–¹æ¡ˆ**ï¼š

**1. ä½¿ç”¨å®¢æˆ·ç«¯ç‰¹å®š APIï¼ˆæœ¬é¡¹ç›®æ¡ˆä¾‹ï¼‰**ï¼š
```javascript
// âŒ é”™è¯¯ï¼šç›´æ¥ä½¿ç”¨ localStorage
export function I18nProvider({ children }) {
  const [lang, setLang] = useState(
    localStorage.getItem('lang') || 'zh' // æœåŠ¡å™¨æ²¡æœ‰ localStorage
  )
  return <div>{lang}</div>
}

// âœ… æ­£ç¡®ï¼šä½¿ç”¨ mounted çŠ¶æ€
export function I18nProvider({ children }) {
  const [lang, setLang] = useState('zh')
  const [mounted, setMounted] = useState(false)
  
  useEffect(() => {
    setMounted(true)
    const saved = localStorage.getItem('lang')
    if (saved) setLang(saved)
  }, [])
  
  if (!mounted) {
    // æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯é¦–æ¬¡æ¸²æŸ“è¿”å›ç›¸åŒå†…å®¹
    return <div style={{ visibility: 'hidden' }}>{children}</div>
  }
  
  return <div>{children}</div>
}
```

**2. æ—¶é—´æˆ³å’Œéšæœºæ•°**ï¼š
```javascript
// âŒ é”™è¯¯
function Component() {
  return <div>å½“å‰æ—¶é—´ï¼š{Date.now()}</div>
}

// âœ… æ­£ç¡®ï¼šå»¶è¿Ÿåˆ°å®¢æˆ·ç«¯
function Component() {
  const [time, setTime] = useState(null)
  
  useEffect(() => {
    setTime(Date.now())
  }, [])
  
  return <div>å½“å‰æ—¶é—´ï¼š{time ?? 'åŠ è½½ä¸­...'}</div>
}

// âœ… æ›´å¥½ï¼šä½¿ç”¨ suppressHydrationWarning
function Component() {
  return (
    <div suppressHydrationWarning>
      å½“å‰æ—¶é—´ï¼š{typeof window !== 'undefined' ? Date.now() : null}
    </div>
  )
}
```

**3. ç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚ React Queryï¼‰**ï¼š
```javascript
// âŒ å¯èƒ½å¯¼è‡´æ°´åˆä¸åŒ¹é…
<QueryClientProvider client={queryClient}>
  <App />
</QueryClientProvider>

// âœ… æ­£ç¡®ï¼šç¦ç”¨åˆå§‹æ°´åˆ
const [queryClient] = useState(() => new QueryClient({
  defaultOptions: {
    queries: {
      staleTime: 60 * 1000,
      // ç¦ç”¨æ°´åˆæ—¶çš„é‡æ–°è·å–
      refetchOnMount: false,
      refetchOnWindowFocus: false,
    },
  },
}))
```

**4. CSS-in-JS**ï¼š
```javascript
// âŒ styled-components ç­‰éœ€è¦ç‰¹æ®Šå¤„ç†
import styled from 'styled-components'

// âœ… ä½¿ç”¨ Tailwind æˆ– CSS Modules é¿å…é—®é¢˜
<div className="p-4 bg-white">...</div>

// âœ… æˆ–è€…é…ç½® styled-components
// next.config.mjs
export default {
  compiler: {
    styledComponents: true
  }
}
```

**5. ä½¿ç”¨ Next.js dynamic**ï¼š
```javascript
import dynamic from 'next/dynamic'

// å®Œå…¨å®¢æˆ·ç«¯æ¸²æŸ“ï¼Œè·³è¿‡ SSR
const ClientOnlyComponent = dynamic(
  () => import('./ClientComponent'),
  { ssr: false }
)

export default function Page() {
  return <ClientOnlyComponent />
}
```

**6. æ¡ä»¶æ¸²æŸ“**ï¼š
```javascript
// âŒ é”™è¯¯ï¼šæ¡ä»¶ä¾èµ–å®¢æˆ·ç«¯çŠ¶æ€
function Component() {
  const isClient = typeof window !== 'undefined'
  return isClient ? <ClientView /> : <ServerView />
}

// âœ… æ­£ç¡®ï¼šä¸¤ä¾§æ¸²æŸ“ç›¸åŒ
function Component() {
  const [isClient, setIsClient] = useState(false)
  
  useEffect(() => {
    setIsClient(true)
  }, [])
  
  // åˆå§‹éƒ½æ¸²æŸ“ ServerView
  return isClient ? <ClientView /> : <ServerView />
}
```

**æœ€ä½³å®è·µæ€»ç»“**ï¼š
1. æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯é¦–æ¬¡æ¸²æŸ“å¿…é¡»ä¸€è‡´
2. ä½¿ç”¨ `useEffect` å»¶è¿Ÿå®¢æˆ·ç«¯ç‰¹å®šé€»è¾‘
3. ä½¿ç”¨ `mounted` çŠ¶æ€æ¨¡å¼ï¼ˆæœ¬é¡¹ç›®é‡‡ç”¨ï¼‰
4. è°¨æ…ä½¿ç”¨ `suppressHydrationWarning`
5. ä¼˜å…ˆä½¿ç”¨ SSG è€Œä¸æ˜¯ SSR é¿å…é—®é¢˜
6. ä½¿ç”¨ `dynamic` çš„ `ssr: false` é€‰é¡¹

---

### 28. å¦‚ä½•è®¾è®¡å’Œå®ç°ä¸€ä¸ªå¯æ‰©å±•çš„ç»„ä»¶åº“æ¶æ„ï¼Ÿ

**ç­”æ¡ˆï¼š**
åŸºäºæœ¬é¡¹ç›®çš„ç»„ä»¶ç»“æ„ï¼Œè®¾è®¡ä¸€ä¸ªå¯æ‰©å±•çš„ç»„ä»¶åº“ï¼š

**ä¸€ã€ç»„ä»¶åˆ†å±‚**ï¼š
```
components/
â”œâ”€â”€ ui/                # åŸºç¡€ UI ç»„ä»¶
â”‚   â”œâ”€â”€ Button.jsx
â”‚   â”œâ”€â”€ Card.jsx
â”‚   â”œâ”€â”€ Badge.jsx
â”‚   â””â”€â”€ ...
â”œâ”€â”€ sections/          # ä¸šåŠ¡ç»„ä»¶
â”‚   â”œâ”€â”€ Hero.jsx
â”‚   â”œâ”€â”€ WorkTimeline.jsx
â”‚   â””â”€â”€ ...
â”œâ”€â”€ layouts/           # å¸ƒå±€ç»„ä»¶
â”‚   â”œâ”€â”€ Navbar.jsx
â”‚   â””â”€â”€ Footer.jsx
â””â”€â”€ features/          # åŠŸèƒ½ç»„ä»¶
    â”œâ”€â”€ ScrollTopButton.jsx
    â””â”€â”€ SectionNav.jsx
```

**äºŒã€åŸºç¡€ç»„ä»¶è®¾è®¡ï¼ˆä»¥ Button ä¸ºä¾‹ï¼‰**ï¼š
```javascript
// components/ui/Button.jsx
import { forwardRef } from 'react'
import { cva } from 'class-variance-authority' // æ¨èä½¿ç”¨
import { cn } from '@/lib/utils'

// å®šä¹‰å˜ä½“
const buttonVariants = cva(
  // åŸºç¡€æ ·å¼
  'inline-flex items-center justify-center rounded-md font-medium transition-colors focus-visible:outline-none disabled:opacity-50',
  {
    variants: {
      variant: {
        default: 'bg-blue-600 text-white hover:bg-blue-700',
        outline: 'border border-gray-300 hover:bg-gray-100',
        ghost: 'hover:bg-gray-100',
        link: 'underline-offset-4 hover:underline'
      },
      size: {
        default: 'h-10 px-4 py-2',
        sm: 'h-9 px-3',
        lg: 'h-11 px-8',
        icon: 'h-10 w-10'
      }
    },
    defaultVariants: {
      variant: 'default',
      size: 'default'
    }
  }
)

const Button = forwardRef(({
  className,
  variant,
  size,
  asChild = false,
  ...props
}, ref) => {
  return (
    <button
      className={cn(buttonVariants({ variant, size, className }))}
      ref={ref}
      {...props}
    />
  )
})

Button.displayName = 'Button'

export { Button, buttonVariants }
```

**ä¸‰ã€å¤åˆç»„ä»¶æ¨¡å¼**ï¼š
```javascript
// components/ui/Card.jsx
const Card = ({ className, ...props }) => (
  <div
    className={cn('rounded-lg border bg-white shadow-sm', className)}
    {...props}
  />
)

const CardHeader = ({ className, ...props }) => (
  <div
    className={cn('flex flex-col space-y-1.5 p-6', className)}
    {...props}
  />
)

const CardTitle = ({ className, ...props }) => (
  <h3
    className={cn('text-2xl font-semibold leading-none', className)}
    {...props}
  />
)

const CardContent = ({ className, ...props }) => (
  <div className={cn('p-6 pt-0', className)} {...props} />
)

export { Card, CardHeader, CardTitle, CardContent }

// ä½¿ç”¨
<Card>
  <CardHeader>
    <CardTitle>æ ‡é¢˜</CardTitle>
  </CardHeader>
  <CardContent>
    å†…å®¹
  </CardContent>
</Card>
```

**å››ã€Hooks æŠ½è±¡**ï¼š
```javascript
// hooks/useMediaQuery.js
import { useState, useEffect } from 'react'

export function useMediaQuery(query) {
  const [matches, setMatches] = useState(false)
  
  useEffect(() => {
    const media = window.matchMedia(query)
    setMatches(media.matches)
    
    const listener = (e) => setMatches(e.matches)
    media.addEventListener('change', listener)
    
    return () => media.removeEventListener('change', listener)
  }, [query])
  
  return matches
}

// ä½¿ç”¨
function Component() {
  const isMobile = useMediaQuery('(max-width: 768px)')
  return isMobile ? <MobileView /> : <DesktopView />
}
```

**äº”ã€ç»„ä»¶æ–‡æ¡£**ï¼š
```javascript
// components/ui/Button.jsx
/**
 * Button ç»„ä»¶
 * 
 * @example
 * <Button variant="default" size="lg" onClick={handleClick}>
 *   ç‚¹å‡»æˆ‘
 * </Button>
 * 
 * @param {object} props
 * @param {'default' | 'outline' | 'ghost' | 'link'} props.variant - æŒ‰é’®å˜ä½“
 * @param {'default' | 'sm' | 'lg' | 'icon'} props.size - æŒ‰é’®å¤§å°
 * @param {string} props.className - é¢å¤–çš„ç±»å
 */
export const Button = ...
```

**å…­ã€ç±»å‹å®‰å…¨ï¼ˆå¦‚æœä½¿ç”¨ TypeScriptï¼‰**ï¼š
```typescript
// components/ui/Button.tsx
import { ButtonHTMLAttributes, forwardRef } from 'react'
import { VariantProps } from 'class-variance-authority'

interface ButtonProps 
  extends ButtonHTMLAttributes<HTMLButtonElement>,
    VariantProps<typeof buttonVariants> {
  asChild?: boolean
}

const Button = forwardRef<HTMLButtonElement, ButtonProps>(
  ({ variant, size, ...props }, ref) => {
    // ...
  }
)
```

**ä¸ƒã€æµ‹è¯•**ï¼š
```javascript
// __tests__/Button.test.jsx
import { render, screen } from '@testing-library/react'
import { Button } from '@/components/ui/Button'

describe('Button', () => {
  it('renders correctly', () => {
    render(<Button>Click me</Button>)
    expect(screen.getByText('Click me')).toBeInTheDocument()
  })
  
  it('applies variant classes', () => {
    render(<Button variant="outline">Click me</Button>)
    expect(screen.getByRole('button')).toHaveClass('border')
  })
})
```

**å…«ã€Storybook é›†æˆ**ï¼š
```javascript
// Button.stories.jsx
export default {
  title: 'UI/Button',
  component: Button,
  argTypes: {
    variant: {
      control: 'select',
      options: ['default', 'outline', 'ghost', 'link']
    }
  }
}

export const Default = {
  args: {
    children: 'Button'
  }
}

export const Outline = {
  args: {
    variant: 'outline',
    children: 'Outline Button'
  }
}
```

---

### 29. è§£é‡Šæœ¬é¡¹ç›®çš„éƒ¨ç½²æµç¨‹ï¼Œå¦‚ä½•å®ç° CI/CDï¼Ÿ

**ç­”æ¡ˆï¼š**
ä»é¡¹ç›®çš„ `deploy.sh` å’Œ `package.json` å¯ä»¥çœ‹å‡ºéƒ¨ç½²é…ç½®ã€‚

**ä¸€ã€éƒ¨ç½²è„šæœ¬åˆ†æ**ï¼š
```bash
# deploy.sh
# 1. æ„å»ºç”Ÿäº§ç‰ˆæœ¬
pnpm build

# 2. ä¼ è¾“æ–‡ä»¶åˆ°æœåŠ¡å™¨ï¼ˆä»æ–‡ä»¶å 21312065_zhangfc.cn_nginx æ¨æµ‹ï¼‰
# å¯èƒ½ä½¿ç”¨ rsync æˆ– scp
rsync -avz --delete .next/ user@server:/path/to/app/.next/
rsync -avz public/ user@server:/path/to/app/public/

# 3. é‡å¯æœåŠ¡
ssh user@server 'pm2 restart next-app'
```

**äºŒã€å®Œæ•´ CI/CD æµç¨‹è®¾è®¡**ï¼š

**1. GitHub Actions é…ç½®**ï¼š
```yaml
# .github/workflows/deploy.yml
name: Deploy to Production

on:
  push:
    branches: [main]

jobs:
  lint:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - uses: pnpm/action-setup@v2
        with:
          version: 8
      
      - uses: actions/setup-node@v3
        with:
          node-version: '20'
          cache: 'pnpm'
      
      - name: Install dependencies
        run: pnpm install --frozen-lockfile
      
      - name: Lint
        run: pnpm lint
      
      - name: Format check
        run: pnpm format:check
  
  build:
    needs: lint
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - uses: pnpm/action-setup@v2
      - uses: actions/setup-node@v3
        with:
          node-version: '20'
          cache: 'pnpm'
      
      - name: Install dependencies
        run: pnpm install --frozen-lockfile
      
      - name: Build
        run: pnpm build
      
      - name: Upload build artifacts
        uses: actions/upload-artifact@v3
        with:
          name: build
          path: .next/
  
  deploy:
    needs: build
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Download build artifacts
        uses: actions/download-artifact@v3
        with:
          name: build
          path: .next/
      
      - name: Deploy to server
        uses: appleboy/scp-action@master
        with:
          host: ${{ secrets.SERVER_HOST }}
          username: ${{ secrets.SERVER_USER }}
          key: ${{ secrets.SSH_PRIVATE_KEY }}
          source: ".next/,public/,package.json"
          target: "/path/to/app"
      
      - name: Restart application
        uses: appleboy/ssh-action@master
        with:
          host: ${{ secrets.SERVER_HOST }}
          username: ${{ secrets.SERVER_USER }}
          key: ${{ secrets.SSH_PRIVATE_KEY }}
          script: |
            cd /path/to/app
            pnpm install --prod
            pm2 restart next-app
```

**2. Vercel éƒ¨ç½²ï¼ˆæ¨èï¼‰**ï¼š
```bash
# å®‰è£… Vercel CLI
pnpm add -g vercel

# ç™»å½•
vercel login

# éƒ¨ç½²
vercel --prod

# æˆ–è€…è¿æ¥ GitHub è‡ªåŠ¨éƒ¨ç½²
```

**3. Docker éƒ¨ç½²**ï¼š
```dockerfile
# Dockerfile
FROM node:20-alpine AS base

# ä¾èµ–é˜¶æ®µ
FROM base AS deps
RUN corepack enable
WORKDIR /app
COPY package.json pnpm-lock.yaml ./
RUN pnpm install --frozen-lockfile

# æ„å»ºé˜¶æ®µ
FROM base AS builder
WORKDIR /app
COPY --from=deps /app/node_modules ./node_modules
COPY . .
RUN corepack enable && pnpm build

# è¿è¡Œé˜¶æ®µ
FROM base AS runner
WORKDIR /app
ENV NODE_ENV production

RUN addgroup --system --gid 1001 nodejs
RUN adduser --system --uid 1001 nextjs

COPY --from=builder /app/public ./public
COPY --from=builder --chown=nextjs:nodejs /app/.next/standalone ./
COPY --from=builder --chown=nextjs:nodejs /app/.next/static ./.next/static

USER nextjs
EXPOSE 3000
ENV PORT 3000

CMD ["node", "server.js"]
```

```yaml
# docker-compose.yml
version: '3.8'
services:
  web:
    build: .
    ports:
      - "3000:3000"
    environment:
      - NODE_ENV=production
    restart: unless-stopped
```

**4. Nginx é…ç½®**ï¼š
```nginx
# /etc/nginx/sites-available/zhangfc.cn
server {
    listen 80;
    listen [::]:80;
    server_name zhangfc.cn www.zhangfc.cn;
    
    # HTTPS redirect
    return 301 https://$server_name$request_uri;
}

server {
    listen 443 ssl http2;
    listen [::]:443 ssl http2;
    server_name zhangfc.cn www.zhangfc.cn;
    
    # SSL è¯ä¹¦
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # å®‰å…¨å¤´
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;
    add_header X-XSS-Protection "1; mode=block" always;
    
    # é™æ€æ–‡ä»¶ç¼“å­˜
    location /_next/static {
        proxy_cache STATIC;
        proxy_pass http://localhost:3000;
        add_header Cache-Control "public, max-age=31536000, immutable";
    }
    
    # å›¾ç‰‡ç¼“å­˜
    location ~* \.(jpg|jpeg|png|gif|ico|webp)$ {
        proxy_cache STATIC;
        proxy_pass http://localhost:3000;
        add_header Cache-Control "public, max-age=31536000, immutable";
    }
    
    # Next.js åº”ç”¨
    location / {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

**5. PM2 é…ç½®**ï¼š
```javascript
// ecosystem.config.js
module.exports = {
  apps: [{
    name: 'next-app',
    script: 'node_modules/next/dist/bin/next',
    args: 'start',
    cwd: '/path/to/app',
    instances: 'max',
    exec_mode: 'cluster',
    env: {
      NODE_ENV: 'production',
      PORT: 3000
    },
    error_file: './logs/err.log',
    out_file: './logs/out.log',
    log_date_format: 'YYYY-MM-DD HH:mm:ss'
  }]
}

// å¯åŠ¨
// pm2 start ecosystem.config.js
// pm2 save
// pm2 startup
```

**ä¸‰ã€éƒ¨ç½²æ£€æŸ¥æ¸…å•**ï¼š
- [ ] ä»£ç é€šè¿‡ lint æ£€æŸ¥
- [ ] æ„å»ºæˆåŠŸ
- [ ] ç¯å¢ƒå˜é‡é…ç½®æ­£ç¡®
- [ ] SSL è¯ä¹¦æœ‰æ•ˆ
- [ ] å¤‡ä»½æ•°æ®åº“ï¼ˆå¦‚æœæœ‰ï¼‰
- [ ] æµ‹è¯•ç”Ÿäº§ç¯å¢ƒ
- [ ] é…ç½®ç›‘æ§å’ŒæŠ¥è­¦
- [ ] è®¾ç½®æ—¥å¿—è®°å½•
- [ ] é…ç½®å¤‡ä»½ç­–ç•¥

---

### 30. å¦‚ä½•ä¸ºè¿™ä¸ªé¡¹ç›®è®¾è®¡ä¸€ä¸ªå®Œæ•´çš„æµ‹è¯•ç­–ç•¥ï¼Ÿ

**ç­”æ¡ˆï¼š**

**ä¸€ã€æµ‹è¯•é‡‘å­—å¡”**ï¼š
```
        /\
       /E2E\       <- å°‘é‡ï¼Œè¦†ç›–å…³é”®æµç¨‹
      /------\
     /Integration\  <- ä¸­é‡ï¼Œæµ‹è¯•ç»„ä»¶äº¤äº’
    /------------\
   /  Unit Tests  \ <- å¤§é‡ï¼Œæµ‹è¯•å‡½æ•°å’Œç»„ä»¶
  /----------------\
```

**äºŒã€å•å…ƒæµ‹è¯•ï¼ˆJest + React Testing Libraryï¼‰**ï¼š

**1. å®‰è£…ä¾èµ–**ï¼š
```bash
pnpm add -D jest @testing-library/react @testing-library/jest-dom jest-environment-jsdom
```

**2. é…ç½®**ï¼š
```javascript
// jest.config.js
const nextJest = require('next/jest')

const createJestConfig = nextJest({
  dir: './',
})

const customJestConfig = {
  setupFilesAfterEnv: ['<rootDir>/jest.setup.js'],
  testEnvironment: 'jest-environment-jsdom',
  moduleNameMapper: {
    '^@/(.*)$': '<rootDir>/src/$1',
  },
  collectCoverageFrom: [
    'src/**/*.{js,jsx}',
    '!src/**/*.stories.{js,jsx}',
    '!src/**/*.test.{js,jsx}',
  ],
  coverageThresholds: {
    global: {
      statements: 80,
      branches: 80,
      functions: 80,
      lines: 80,
    },
  },
}

module.exports = createJestConfig(customJestConfig)
```

**3. æµ‹è¯•ç¤ºä¾‹**ï¼š
```javascript
// __tests__/components/ui/Button.test.jsx
import { render, screen, fireEvent } from '@testing-library/react'
import { Button } from '@/components/ui/Button'

describe('Button', () => {
  it('renders with text', () => {
    render(<Button>Click me</Button>)
    expect(screen.getByText('Click me')).toBeInTheDocument()
  })
  
  it('handles click events', () => {
    const handleClick = jest.fn()
    render(<Button onClick={handleClick}>Click me</Button>)
    
    fireEvent.click(screen.getByText('Click me'))
    expect(handleClick).toHaveBeenCalledTimes(1)
  })
  
  it('applies custom className', () => {
    render(<Button className="custom-class">Click me</Button>)
    expect(screen.getByRole('button')).toHaveClass('custom-class')
  })
  
  it('is disabled when disabled prop is true', () => {
    render(<Button disabled>Click me</Button>)
    expect(screen.getByRole('button')).toBeDisabled()
  })
})

// __tests__/lib/utils.test.js
import { cn } from '@/lib/utils'

describe('cn utility', () => {
  it('merges class names correctly', () => {
    expect(cn('px-2', 'px-4')).toBe('px-4')
    expect(cn('px-2 py-1', { 'bg-blue': true })).toContain('bg-blue')
  })
})
```

**ä¸‰ã€é›†æˆæµ‹è¯•**ï¼š
```javascript
// __tests__/integration/i18n.test.jsx
import { render, screen, fireEvent, waitFor } from '@testing-library/react'
import { I18nProvider } from '@/lib/i18n'

describe('I18n Integration', () => {
  beforeEach(() => {
    localStorage.clear()
  })
  
  it('loads language from localStorage', async () => {
    localStorage.setItem('lang', 'en')
    
    render(
      <I18nProvider>
        <TestComponent />
      </I18nProvider>
    )
    
    await waitFor(() => {
      expect(screen.getByText(/english/i)).toBeInTheDocument()
    })
  })
  
  it('toggles language', async () => {
    const { container } = render(
      <I18nProvider>
        <TestComponent />
      </I18nProvider>
    )
    
    await waitFor(() => {
      expect(container.querySelector('[data-lang]')).toHaveAttribute('data-lang', 'zh')
    })
    
    fireEvent.click(screen.getByRole('button', { name: /toggle/i }))
    
    await waitFor(() => {
      expect(container.querySelector('[data-lang]')).toHaveAttribute('data-lang', 'en')
    })
  })
})
```

**å››ã€E2E æµ‹è¯•ï¼ˆPlaywrightï¼‰**ï¼š

**1. å®‰è£…**ï¼š
```bash
pnpm add -D @playwright/test
npx playwright install
```

**2. é…ç½®**ï¼š
```javascript
// playwright.config.js
import { defineConfig } from '@playwright/test'

export default defineConfig({
  testDir: './e2e',
  fullyParallel: true,
  forbidOnly: !!process.env.CI,
  retries: process.env.CI ? 2 : 0,
  workers: process.env.CI ? 1 : undefined,
  use: {
    baseURL: 'http://localhost:3000',
    trace: 'on-first-retry',
    screenshot: 'only-on-failure',
  },
  webServer: {
    command: 'pnpm dev',
    url: 'http://localhost:3000',
    reuseExistingServer: !process.env.CI,
  },
})
```

**3. æµ‹è¯•ç¤ºä¾‹**ï¼š
```javascript
// e2e/navigation.spec.js
import { test, expect } from '@playwright/test'

test.describe('Navigation', () => {
  test('navigates to about page', async ({ page }) => {
    await page.goto('/')
    
    await page.click('text=å…³äº')
    await expect(page).toHaveURL('/about')
    await expect(page.locator('h1')).toContainText('å…³äº')
  })
  
  test('scrolls to sections', async ({ page }) => {
    await page.goto('/')
    
    await page.click('a[href="#skills"]')
    await expect(page.locator('#skills')).toBeInViewport()
  })
  
  test('changes language', async ({ page }) => {
    await page.goto('/')
    
    await page.click('[aria-label="Toggle language"]')
    await expect(page.locator('html')).toHaveAttribute('lang', 'en')
  })
})

// e2e/seo.spec.js
test.describe('SEO', () => {
  test('has correct meta tags', async ({ page }) => {
    await page.goto('/')
    
    await expect(page).toHaveTitle(/å¼ èŠ³æœ/)
    
    const description = await page.locator('meta[name="description"]').getAttribute('content')
    expect(description).toContain('å…¨æ ˆå¼€å‘å·¥ç¨‹å¸ˆ')
    
    const ogTitle = await page.locator('meta[property="og:title"]').getAttribute('content')
    expect(ogTitle).toBeTruthy()
  })
})

// e2e/performance.spec.js
test('meets performance standards', async ({ page }) => {
  await page.goto('/')
  
  // æµ‹è¯• LCP
  const lcp = await page.evaluate(() => {
    return new Promise((resolve) => {
      new PerformanceObserver((list) => {
        const entries = list.getEntries()
        const lastEntry = entries[entries.length - 1]
        resolve(lastEntry.renderTime || lastEntry.loadTime)
      }).observe({ type: 'largest-contentful-paint', buffered: true })
    })
  })
  
  expect(lcp).toBeLessThan(2500) // < 2.5s
})
```

**äº”ã€è§†è§‰å›å½’æµ‹è¯•**ï¼š
```javascript
// e2e/visual.spec.js
import { test, expect } from '@playwright/test'

test('homepage looks correct', async ({ page }) => {
  await page.goto('/')
  await expect(page).toHaveScreenshot('homepage.png')
})

test('mobile view looks correct', async ({ page }) => {
  await page.setViewportSize({ width: 375, height: 667 })
  await page.goto('/')
  await expect(page).toHaveScreenshot('homepage-mobile.png')
})
```

**å…­ã€æµ‹è¯•è¦†ç›–ç‡**ï¼š
```javascript
// package.json
{
  "scripts": {
    "test": "jest",
    "test:watch": "jest --watch",
    "test:coverage": "jest --coverage",
    "test:e2e": "playwright test",
    "test:e2e:ui": "playwright test --ui",
    "test:all": "pnpm test:coverage && pnpm test:e2e"
  }
}
```

**ä¸ƒã€CI ä¸­çš„æµ‹è¯•**ï¼š
```yaml
# .github/workflows/test.yml
name: Test

on: [push, pull_request]

jobs:
  unit:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: pnpm/action-setup@v2
      - uses: actions/setup-node@v3
        with:
          node-version: '20'
          cache: 'pnpm'
      - run: pnpm install
      - run: pnpm test:coverage
      - uses: codecov/codecov-action@v3
        with:
          files: ./coverage/lcov.info
  
  e2e:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: pnpm/action-setup@v2
      - uses: actions/setup-node@v3
        with:
          node-version: '20'
          cache: 'pnpm'
      - run: pnpm install
      - run: npx playwright install --with-deps
      - run: pnpm test:e2e
      - uses: actions/upload-artifact@v3
        if: always()
        with:
          name: playwright-report
          path: playwright-report/
```

**æµ‹è¯•æœ€ä½³å®è·µ**ï¼š
1. éµå¾ª AAA æ¨¡å¼ï¼ˆArrange-Act-Assertï¼‰
2. æµ‹è¯•ç”¨æˆ·è¡Œä¸ºï¼Œè€Œä¸æ˜¯å®ç°ç»†èŠ‚
3. ä½¿ç”¨æœ‰æ„ä¹‰çš„æµ‹è¯•æè¿°
4. ä¿æŒæµ‹è¯•ç‹¬ç«‹å’Œå¯é‡å¤
5. åœ¨ CI ä¸­è¿è¡Œæ‰€æœ‰æµ‹è¯•
6. è¿½è¸ªæµ‹è¯•è¦†ç›–ç‡
7. å®šæœŸæ›´æ–°æµ‹è¯•

---

## æ€»ç»“

è¿™å¥—é¢è¯•é¢˜æ¶µç›–äº†ï¼š
- **åŸºç¡€çŸ¥è¯†**ï¼ˆ1-10ï¼‰ï¼šNext.jsã€Reactã€Tailwind CSSã€å·¥å…·é“¾
- **è¿›é˜¶åº”ç”¨**ï¼ˆ11-20ï¼‰ï¼šå›½é™…åŒ–ã€SSRã€æ€§èƒ½ä¼˜åŒ–ã€ç»„ä»¶è®¾è®¡
- **é«˜çº§æ¶æ„**ï¼ˆ21-30ï¼‰ï¼šæ¸²æŸ“ç­–ç•¥ã€æ€§èƒ½ç›‘æ§ã€CI/CDã€æµ‹è¯•

åŸºäºæ‚¨çš„é¡¹ç›®æŠ€æœ¯æ ˆï¼š
- âœ… Next.js 16 (App Router)
- âœ… React 19
- âœ… Tailwind CSS 4
- âœ… å›½é™…åŒ–
- âœ… SEO ä¼˜åŒ–
- âœ… ä»£ç è§„èŒƒå·¥å…·é“¾
- âœ… ç°ä»£åŒ–éƒ¨ç½²

è¿™äº›é¢˜ç›®ä¸ä»…è€ƒå¯Ÿç†è®ºçŸ¥è¯†ï¼Œæ›´æ³¨é‡å®é™…é¡¹ç›®ç»éªŒå’Œæœ€ä½³å®è·µã€‚

